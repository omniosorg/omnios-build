diff -wpruN --no-dereference '--exclude=*.orig' a~/lib/ldap.c a/lib/ldap.c
--- a~/lib/ldap.c	1970-01-01 00:00:00
+++ a/lib/ldap.c	1970-01-01 00:00:00
@@ -1041,8 +1041,12 @@ void Curl_ldap_version(char *buf, size_t
                    api.ldapai_vendor_name, major, minor, patch, flavor);
 
     ldap_memfree(api.ldapai_vendor_name);
+#ifdef __illumos__
+    ldap_value_free(api.ldapai_extensions);
+#else
     ber_memvfree((void **)api.ldapai_extensions);
 #endif
+#endif
   }
   else
     curl_msnprintf(buf, bufsz, "LDAP/1");
